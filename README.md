# hddnosleep

Маленькая (21 Кб на диске и несколько мегабайт в памяти) программа, которая постоянно записывает файл на диск, чтобы тот не уходил в спящий режим и не парковал головки.

## А зачем?

Мой HDD периодически издавал звук, похожий на открывание скрипучей двери. Оказалось, это происходило в момент парковки головок. И диск очень часто это делал. Вроде бы диски это делают для сокращения энергопотребления; но звук очень уж раздражающий, так что я искал пути уменьшения количества парковок.

Для этого есть два пути:

- Постоянно записывать файл на диск — диск будет считать, что его активно используют и не будет уходить в спящий режим.
- Изменить значение APM диска (например, с помощью smartctl или hdparm). В некоторых моделях нет доступа к APM.

Можно совмещать оба варианта. 

## Настройка

- **FILENAME** — путь к файлу, который будет записываться.
- **loop_duration** — как часто записывать файл (в некоторых моделях HDD WD, например, головки паркуются каждые 8 секунд неактивности, поэтому у меня стоит 7 секунд; у других производителей могут быть другие интервалы).

Всё это меняется прямо в исходном файле. Меняете, компилируете, используете. 

Я не стал делать отдельный конфиг, потому что у зига компактный кроссплатформенный компилятор, который легко использовать.

## Компиляция

```cmd
zig build-exe hddnosleep.zig -O ReleaseSmall
```

## Установка как сервис

Через [NSSM](https://nssm.cc):

```cmd
nssm.exe install hddnosleep
```
